
<p-toolbar styleClass="mb-6">
    <ng-template #start>
        <p-button label="Nuevo" icon="pi pi-plus" class="p-button-success mr-2" class="mr-2" 
            (click)="store.openModalCreate()"/>
    </ng-template>

</p-toolbar>

<p-table
    [value]="store.categorias()" 
    [tableStyle]="{ 'min-width': '90rem' }"
    [paginator]="true" 
    [rows]="store.perPage()"
    [totalRecords]="store.totalItems()"
    (onPage)="onPageChange($event)"
    
    [showCurrentPageReport]="true"
    responsiveLayout="scroll"
    [rowHover]="true"
    currentPageReportTemplate="Mostrando {first} a {last} de {totalRecords} categorías"
    [globalFilterFields]="['nombre','descripcion','tipo']"
    [lazy]="true">

      <ng-template pTemplate="caption">
      <div class="flex items-center justify-between">
        <p class="font-bold font-mono text-2xl py-1" >CATEGORIAS</p>
        <div class="flex items-center gap-2">
            
                <p-dropdown
                    id="backendFilterStatus"                    
                    placeholder="Todos los tipos"
                    optionLabel="label"
                    optionValue="value">
                </p-dropdown>
                <p-dropdown
                    id="backendFilterStatus"                    
                    placeholder="Activos"
                    optionLabel="label"
                    optionValue="value">
                </p-dropdown>

                <p-iconfield>
                    <p-inputicon styleClass="pi pi-search" />
                    <input id="backendFilterNombre"
                          #nombreInput
                          type="text"
                          pInputText
                          
                         
                          placeholder="Buscar..." />
                </p-iconfield>
                <p-button label="Limpiar Filtros" icon="pi pi-filter-slash" severity="secondary">
                </p-button>      
            </div>
                 <!-- <p-iconfield>
                        <p-inputicon styleClass="pi pi-search" />
                        <input pInputText type="text" placeholder="Buscar..." />
                </p-iconfield> -->
                
        </div>
        
    </ng-template>
    

    <ng-template pTemplate="header">
        <tr>
            <th style="width: 4%" pSortableColumn="id">ID</th>
            <th style="width:20%" pSortableColumn="nombre">Nombre <p-sortIcon field="nombre"></p-sortIcon></th>
            <th style="width:20%" pSortableColumn="tipo">Tipo</th>
            <th style="width:20%" pSortableColumn="estado">Estado</th>
            <th style="width:15%" pSortableColumn="acciones">Acciones</th>
        </tr>
    </ng-template>

    <ng-template pTemplate="body" let-categoria>
        <tr>
            <td>{{ categoria.id }}</td>
            <td>{{ categoria.nombre }}</td>

            <td><p-tag [value]="categoria.tipo | titlecase"
                   [severity]="getSeverityForTipo(categoria.tipo)"></p-tag></td>
            <td>
                <p-tag [value]="categoria.estado ? 'Activo' : 'Inactivo'"
                     [severity]="getSeverity(categoria.estado)"></p-tag>
            </td>
            <td>
                <div class="flex gap-2">
                    <p-button icon="pi pi-eye" [rounded]="true" [outlined]="true" severity="info"
                        (click)="store.openModalDetalle(categoria)" pTooltip="Ver Detalle" tooltipPosition="top"/>

                    <p-button icon="pi pi-pencil" [rounded]="true" [outlined]="true"
                        (click)="store.openModalEdit(categoria)" pTooltip="Editar" tooltipPosition="top"/>
                    
                    @if (categoria.estado) {
                        <p-button icon="pi pi-trash" severity="danger" [rounded]="true" [outlined]="true"
                            (click)="confirmDelete(categoria.id)" pTooltip="Desactivar" tooltipPosition="top"/>
                    } @else {
                        <p-button icon="pi pi-history" severity="warn" [rounded]="true" [outlined]="true"
                            (click)="store.doRestore(categoria.id)" pTooltip="Activar" tooltipPosition="top"/>
                    }
                </div>
            </td>
        </tr>
    </ng-template>

    <ng-template pTemplate="emptymessage">
        <tr>
            <td colspan="5">No se encontraron categorías</td>
        </tr>
    </ng-template>
</p-table>
<app-create />
<app-edit />
<app-detalle />
<p-toast></p-toast>
<p-confirmDialog acceptLabel="Si"></p-confirmDialog>
